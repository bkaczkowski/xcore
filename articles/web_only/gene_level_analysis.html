<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="xcore">
<title>Modeling expression changes at gene level • xcore</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Modeling expression changes at gene level">
<meta property="og:description" content="xcore">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">xcore</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/web_only/gene_level_analysis.html">Modeling expression changes at gene level</a>
    <a class="dropdown-item" href="../../articles/xcore_vignette.html">xcore vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Modeling expression changes at gene level</h1>
                        <h4 data-toc-skip class="author">Migdal</h4>
            
            <h4 data-toc-skip class="date">2/15/2022</h4>
      
      
      <div class="d-none name"><code>gene_level_analysis.Rmd</code></div>
    </div>

    
    
<style>
body {
text-align: justify}
</style>
<div class="section level2">
<h2 id="version-notice">VERSION NOTICE<a class="anchor" aria-label="anchor" href="#version-notice"></a>
</h2>
<p>This vignette uses xcore version 1.2.0, which is still in devel
branch of Biocondutor and to be realeased in mid-Octorber. To use it
please install xcore and xcoredata from the devel branch.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"devel"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"xcore"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"xcoredata"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette extends the <a href="https://bkaczkowski.github.io/xcore/articles/xcore_vignette.html" class="external-link">xcore
user guide</a> by showing how to perform gene level expression modeling
using RNA-seq and microarray input data.</p>
<p>In <em>xcore</em> we model the expression as a function of promoter’s
sequence described by the ChIP-seq signatures. Similarly to differential
expression analysis, one can consider the expression at the level of
genes or transcripts. While most of the analysis steps would be
identical for the two variants, the key difference is in the choice of
promoters annotation. Particularly, different gene’s transcripts can
have distinct promoters. One the other hand, expression at gene level is
an aggregation of transcripts expression yet we would rather like to use
only one promoter to describe a single gene.</p>
<p><em>xcoredata</em> provides ChIP-seq based molecular signatures
constructed against FANTOM5 promoters. These promoters correspond to
transcripts’ promoters making them very easy to use with CAGE data
mapped to FANTOM5 reference (as exemplified in <a href="https://bkaczkowski.github.io/xcore/articles/xcore_vignette.html" class="external-link">xcore
user guide</a>). Additionally, <em>xcoredata</em> provides a set of core
FANTOM5 promoters (<code>promoters_f5_core</code>) which defines only
one promoter per gene. Using this core set of promoters it is possible
to construct a gene level analysis with non-CAGE data, by matching input
gene identifiers with core FANTOM5 promoters.</p>
<p>The reminder of this document shows how to construct a gene level
<em>xcore</em> analysis. For this purpose we use publicly available
RNA-seq time-series dataset obtained from classic TGFꞵ induced
epithelial-to-mesenchymal transition experiment conducted in A-549 cell
line (<a href="https://doi.org/10.1093/nar/gkw126" class="external-link">Chang H, et al. NAR.
2016.</a>, <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE69667" class="external-link">GSE69667</a>).
The other example uses microarray time-series dataset also from TGFꞵ
induced epithelial-to-mesenchymal transition experiment conducted in
A-549 cell line (<a href="https://pubmed.ncbi.nlm.nih.gov/20007254/" class="external-link">Sartor MA, et
al. Bioinformatics. 2010.</a>, <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE17708" class="external-link">GSE17708</a>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"xcore"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"xcoredata"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="rna-seq-data">RNA-seq data<a class="anchor" aria-label="anchor" href="#rna-seq-data"></a>
</h2>
<div class="section level3">
<h3 id="obtaining-the-expression-data">Obtaining the expression data<a class="anchor" aria-label="anchor" href="#obtaining-the-expression-data"></a>
</h3>
<p>We have downloaded the raw counts and metadata for GSE69667 study
from <a href="http://www.ilincs.org/apps/grein/?gse=GSE69667" class="external-link">GREIN</a>
portal that provide raw counts for many RNA-seq datasets deposited in
the GEO repository. Before these can be used in <em>xcore</em>
framework, downloaded metadata needs to be combined with raw counts.</p>
<p>If you are interested in the processing details, look up the Rmd
source file of this vignette.</p>
<p>Here we recommend that ready to use counts matrix can be downloaded
from our server.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://zdglab.iimcb.gov.pl/mmigdal/GSE69667.rda"</span>, </span>
<span>              destfile <span class="op">=</span> <span class="st">"GSE69667.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"GSE69667.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="constructing-experiment-design">Constructing experiment design<a class="anchor" aria-label="anchor" href="#constructing-experiment-design"></a>
</h3>
<p>The code below shows how to construct design matrix, by taking
advantage of the patterns present in the sample names.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">counts_rna_seq</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="6%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">0h_rep1</th>
<th align="right">0h_rep2</th>
<th align="right">6h_rep1</th>
<th align="right">6h_rep2</th>
<th align="right">12h_rep1</th>
<th align="right">12h_rep2</th>
<th align="right">24h_rep1</th>
<th align="right">24h_rep2</th>
<th align="right">36h_rep1</th>
<th align="right">36h_rep2</th>
<th align="right">48h_rep1</th>
<th align="right">48h_rep2</th>
<th align="right">72h_rep1</th>
<th align="right">72h_rep2</th>
<th align="right">96h_rep1</th>
<th align="right">96h_rep2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TSPAN6</td>
<td align="right">1433</td>
<td align="right">1237</td>
<td align="right">1884</td>
<td align="right">1749</td>
<td align="right">885</td>
<td align="right">1623</td>
<td align="right">1146</td>
<td align="right">1582</td>
<td align="right">1453</td>
<td align="right">1866</td>
<td align="right">2253</td>
<td align="right">2126</td>
<td align="right">1537</td>
<td align="right">1990</td>
<td align="right">1528</td>
<td align="right">2487</td>
</tr>
<tr class="even">
<td align="left">TNMD</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">9</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">DPM1</td>
<td align="right">1066</td>
<td align="right">881</td>
<td align="right">1738</td>
<td align="right">1450</td>
<td align="right">706</td>
<td align="right">1214</td>
<td align="right">918</td>
<td align="right">912</td>
<td align="right">901</td>
<td align="right">931</td>
<td align="right">1343</td>
<td align="right">931</td>
<td align="right">870</td>
<td align="right">890</td>
<td align="right">926</td>
<td align="right">966</td>
</tr>
<tr class="even">
<td align="left">SCYL3</td>
<td align="right">531</td>
<td align="right">597</td>
<td align="right">412</td>
<td align="right">506</td>
<td align="right">425</td>
<td align="right">491</td>
<td align="right">432</td>
<td align="right">458</td>
<td align="right">459</td>
<td align="right">483</td>
<td align="right">488</td>
<td align="right">552</td>
<td align="right">451</td>
<td align="right">563</td>
<td align="right">548</td>
<td align="right">489</td>
</tr>
<tr class="odd">
<td align="left">C1orf112</td>
<td align="right">741</td>
<td align="right">752</td>
<td align="right">736</td>
<td align="right">937</td>
<td align="right">589</td>
<td align="right">768</td>
<td align="right">645</td>
<td align="right">509</td>
<td align="right">548</td>
<td align="right">586</td>
<td align="right">425</td>
<td align="right">563</td>
<td align="right">335</td>
<td align="right">578</td>
<td align="right">522</td>
<td align="right">510</td>
</tr>
<tr class="even">
<td align="left">FGR</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_.*"</span>, replacement <span class="op">=</span> <span class="st">""</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts_rna_seq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ncond</span> <span class="op">&lt;-</span> <span class="va">cond</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ncond</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ncond</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">cond</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cond</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts_rna_seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cond</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">0h</th>
<th align="right">6h</th>
<th align="right">12h</th>
<th align="right">24h</th>
<th align="right">36h</th>
<th align="right">48h</th>
<th align="right">72h</th>
<th align="right">96h</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0h_rep1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">0h_rep2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">6h_rep1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">6h_rep2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">12h_rep1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">12h_rep2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">24h_rep1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">24h_rep2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">36h_rep1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">36h_rep2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">48h_rep1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">48h_rep2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">72h_rep1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">72h_rep2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">96h_rep1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">96h_rep2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="obtaining-core-promoters-annotation-and-molecular-signatures">Obtaining core promoters annotation and molecular signatures<a class="anchor" aria-label="anchor" href="#obtaining-core-promoters-annotation-and-molecular-signatures"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">promoters_f5_core</span> <span class="op">&lt;-</span> <span class="fu">xcoredata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcoredata/man/promoters_f5_core.html" class="external-link">promoters_f5_core</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">remap_promoters_f5</span> <span class="op">&lt;-</span> <span class="fu">xcoredata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcoredata/man/remap_promoters_f5.html" class="external-link">remap_promoters_f5</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="translating-gene-symbols-into-fantom5-core-promoters">Translating gene symbols into FANTOM5 core promoters<a class="anchor" aria-label="anchor" href="#translating-gene-symbols-into-fantom5-core-promoters"></a>
</h3>
<p>This is the key step in gene level analysis. First we obtain a
character vector mapping gene symbols to FANTOM5 core promoters. Then we
can use it to translate our counts matrix using
<code>translateCounts</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eh</span> <span class="op">&lt;-</span> <span class="fu">ExperimentHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html" class="external-link">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## snapshotDate(): 2022-08-23</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">symbol2fantom</span> <span class="op">&lt;-</span> <span class="va">eh</span><span class="op">[[</span><span class="st">"EH7700"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?xcoredata and browseVignettes('xcoredata') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts_rna_seq_fantom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/translateCounts.html">translateCounts</a></span><span class="op">(</span><span class="va">counts_rna_seq</span>, dict <span class="op">=</span> <span class="va">symbol2fantom</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="processing-the-counts-and-molecular-signatures">Processing the counts and molecular signatures<a class="anchor" aria-label="anchor" href="#processing-the-counts-and-molecular-signatures"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mae_rna_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/prepareCountsForRegression.html">prepareCountsForRegression</a></span><span class="op">(</span></span>
<span>  counts <span class="op">=</span> <span class="va">counts_rna_seq_fantom</span>,</span>
<span>  design <span class="op">=</span> <span class="va">design</span>,</span>
<span>  base_lvl <span class="op">=</span> <span class="st">"0h"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mae_rna_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/addSignatures.html">addSignatures</a></span><span class="op">(</span><span class="va">mae_rna_seq</span>, remap <span class="op">=</span> <span class="va">remap_promoters_f5</span><span class="op">)</span></span>
<span><span class="va">mae_rna_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/filterSignatures.html">filterSignatures</a></span><span class="op">(</span><span class="va">mae_rna_seq</span>, min <span class="op">=</span> <span class="fl">0.05</span>, max <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modeling-gene-expression">Modeling gene expression<a class="anchor" aria-label="anchor" href="#modeling-gene-expression"></a>
</h3>
<p>As always, depending on infrastructure you are using this step can be
time consuming.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># register parallel backend</span></span>
<span><span class="fu">doMC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doMC/man/registerDoMC.html" class="external-link">registerDoMC</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">314159265</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_rna_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/modelGeneExpression.html">modelGeneExpression</a></span><span class="op">(</span></span>
<span>  mae <span class="op">=</span> <span class="va">mae_rna_seq</span>,</span>
<span>  xnames <span class="op">=</span> <span class="st">"remap"</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploring-results">Exploring results<a class="anchor" aria-label="anchor" href="#exploring-results"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_signatures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_rna_seq</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">remap</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu">pheatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span></span>
<span>  mat <span class="op">=</span> <span class="va">top_signatures</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>,</span>
<span>  labels_row <span class="op">=</span> <span class="va">top_signatures</span><span class="op">$</span><span class="va">name</span>,</span>
<span>  cluster_cols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">35</span><span class="op">)</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, to <span class="op">=</span> <span class="fl">0.1</span>, length.out <span class="op">=</span> <span class="fl">36</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"TGFꞵ EMT in A-549 cell line (GSE69667)\nReMap2020molecular signatures activity"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="gene_level_analysis_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="microarray-data">Microarray data<a class="anchor" aria-label="anchor" href="#microarray-data"></a>
</h2>
<div class="section level3">
<h3 id="obtaining-the-expression-data-1">Obtaining the expression data<a class="anchor" aria-label="anchor" href="#obtaining-the-expression-data-1"></a>
</h3>
<p>Here, we have downloaded supplementary data file containing
pre-processed data from <a href="">GSE17708</a> study. This
supplementary file is an xls file that needs to be loaded to R and
converted into matrix before we can use it.</p>
<p>Ready to use “counts” matrix (these are not raw counts) can be
downloaded from our server.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://zdglab.iimcb.gov.pl/mmigdal/GSE17708.rda"</span>, </span>
<span>              destfile <span class="op">=</span> <span class="st">"GSE17708.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"GSE17708.rda"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">counts_microarray</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="2%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">0hr_1</th>
<th align="right">0hr_2</th>
<th align="right">0hr_3</th>
<th align="right">0.5hr_1</th>
<th align="right">0.5hr_2</th>
<th align="right">0.5hr_3</th>
<th align="right">1hr_1</th>
<th align="right">1hr_2</th>
<th align="right">1hr_3</th>
<th align="right">2hr_1</th>
<th align="right">2hr_2</th>
<th align="right">4hr_1</th>
<th align="right">4hr_2</th>
<th align="right">4hr_3</th>
<th align="right">8hr_1</th>
<th align="right">8hr_2</th>
<th align="right">8hr_3</th>
<th align="right">16hr_1</th>
<th align="right">16hr_2</th>
<th align="right">16hr_3</th>
<th align="right">24hr_1</th>
<th align="right">24hr_2</th>
<th align="right">24hr_3</th>
<th align="right">72hr_1</th>
<th align="right">72hr_2</th>
<th align="right">72hr_3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">780</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">16</td>
<td align="right">15</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">16</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">5982</td>
<td align="right">7</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">3310</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">7849</td>
<td align="right">20</td>
<td align="right">19</td>
<td align="right">20</td>
<td align="right">20</td>
<td align="right">20</td>
<td align="right">20</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">20</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">20</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">20</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="left">2978</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">7318</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="constructing-experiment-design-1">Constructing experiment design<a class="anchor" aria-label="anchor" href="#constructing-experiment-design-1"></a>
</h3>
<p>Again we construct design matrix, by taking advantage of the patterns
present in the sample names.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_.*"</span>, replacement <span class="op">=</span> <span class="st">""</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts_microarray</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ncond</span> <span class="op">&lt;-</span> <span class="va">cond</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ncond</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ncond</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">cond</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cond</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts_microarray</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cond</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">0hr</th>
<th align="right">0.5hr</th>
<th align="right">1hr</th>
<th align="right">2hr</th>
<th align="right">4hr</th>
<th align="right">8hr</th>
<th align="right">16hr</th>
<th align="right">24hr</th>
<th align="right">72hr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0hr_1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">0hr_2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">0hr_3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">0.5hr_1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">0.5hr_2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">0.5hr_3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1hr_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">1hr_2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1hr_3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2hr_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2hr_2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">4hr_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">4hr_2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">4hr_3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">8hr_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">8hr_2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">8hr_3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">16hr_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">16hr_2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">16hr_3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">24hr_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">24hr_2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">24hr_3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">72hr_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">72hr_2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">72hr_3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="translating-gene-symbols-into-fantom5-core-promoters-1">Translating gene symbols into FANTOM5 core promoters<a class="anchor" aria-label="anchor" href="#translating-gene-symbols-into-fantom5-core-promoters-1"></a>
</h3>
<p>Next, we need to translate expression matrix’s row IDs to FANTOM5
core promoters. The only difference is that this time we map ENTREZ IDs
to FANTOM5 promoters.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eh</span> <span class="op">&lt;-</span> <span class="fu">ExperimentHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html" class="external-link">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## snapshotDate(): 2022-08-23</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">entrez2fantom</span> <span class="op">&lt;-</span> <span class="va">eh</span><span class="op">[[</span><span class="st">"EH7699"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?xcoredata and browseVignettes('xcoredata') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts_fantom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/translateCounts.html">translateCounts</a></span><span class="op">(</span><span class="va">counts_microarray</span>, dict <span class="op">=</span> <span class="va">entrez2fantom</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="processing-the-counts-and-molecular-signatures-1">Processing the counts and molecular signatures<a class="anchor" aria-label="anchor" href="#processing-the-counts-and-molecular-signatures-1"></a>
</h3>
<p>Here, our workflow deviates from the previous example. Because, we
use the pre-processed expression data we don’t really want to normalize
it. Instead we will use the data as is.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mae_microarray</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/regressionData.html">regressionData</a></span><span class="op">(</span></span>
<span>  expr_mat <span class="op">=</span> <span class="va">counts_fantom</span>,</span>
<span>  design <span class="op">=</span> <span class="va">design</span>,</span>
<span>  base_lvl <span class="op">=</span> <span class="st">"0hr"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mae_microarray</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/addSignatures.html">addSignatures</a></span><span class="op">(</span><span class="va">mae_microarray</span>, remap <span class="op">=</span> <span class="va">remap_promoters_f5</span><span class="op">)</span></span>
<span><span class="va">mae_microarray</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/filterSignatures.html">filterSignatures</a></span><span class="op">(</span><span class="va">mae_microarray</span>, min <span class="op">=</span> <span class="fl">0.05</span>, max <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modeling-gene-expression-1">Modeling gene expression<a class="anchor" aria-label="anchor" href="#modeling-gene-expression-1"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># register parallel backend</span></span>
<span><span class="fu">doMC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doMC/man/registerDoMC.html" class="external-link">registerDoMC</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">314159265</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_microarray</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/modelGeneExpression.html">modelGeneExpression</a></span><span class="op">(</span></span>
<span>  mae <span class="op">=</span> <span class="va">mae_microarray</span>,</span>
<span>  xnames <span class="op">=</span> <span class="st">"remap"</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploring-results-1">Exploring results<a class="anchor" aria-label="anchor" href="#exploring-results-1"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_signatures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_microarray</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">remap</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu">pheatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span></span>
<span>  mat <span class="op">=</span> <span class="va">top_signatures</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>,</span>
<span>  labels_row <span class="op">=</span> <span class="va">top_signatures</span><span class="op">$</span><span class="va">name</span>,</span>
<span>  cluster_cols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">35</span><span class="op">)</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>, to <span class="op">=</span> <span class="fl">0.05</span>, length.out <span class="op">=</span> <span class="fl">36</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"TGFꞵ EMT in A-549 cell line (GSE17708)\nReMap2020 molecular signatures activity"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="gene_level_analysis_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Maciej Migdał, Bogumił Kaczkowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
