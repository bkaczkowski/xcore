<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="modelGeneExpression uses parallelization if parallel backend is
registered. For that reason we advise against passing parallel argument
to internally called cv.glmnet routine."><title>Gene expression modeling pipeline — modelGeneExpression • xcore</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gene expression modeling pipeline — modelGeneExpression"><meta property="og:description" content="modelGeneExpression uses parallelization if parallel backend is
registered. For that reason we advise against passing parallel argument
to internally called cv.glmnet routine."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xcore</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/web_only/gene_level_analysis.html">Modeling expression changes at gene level</a>
    <a class="dropdown-item" href="../articles/xcore_vignette.html">xcore vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Gene expression modeling pipeline</h1>
      
      <div class="d-none name"><code>modelGeneExpression.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>modelGeneExpression</code> uses parallelization if parallel backend is
registered. For that reason we advise against passing <code>parallel</code> argument
to internally called <code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></code> routine.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modelGeneExpression</span><span class="op">(</span></span>
<span>  <span class="va">mae</span>,</span>
<span>  yname <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  uname <span class="op">=</span> <span class="st">"U"</span>,</span>
<span>  <span class="va">xnames</span>,</span>
<span>  design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pvalues <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  precalcmodels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mae</dt>
<dd><p>MultiAssayExperiment object such as produced by
<code><a href="prepareCountsForRegression.html">prepareCountsForRegression</a></code>.</p></dd>


<dt>yname</dt>
<dd><p>string indicating experiment in <code>mae</code> to use as the
expression input.</p></dd>


<dt>uname</dt>
<dd><p>string indicating experiment in <code>mae</code> to use as the basal
expression level.</p></dd>


<dt>xnames</dt>
<dd><p>character indicating experiments in <code>mae</code> to use as
molecular signatures.</p></dd>


<dt>design</dt>
<dd><p>matrix giving the design matrix for the samples. Default
(<code>NULL</code>) is to use design found in <code>mae</code> metadata. Columns
corresponds to samples groups and rows to samples names. Only samples
included in the design will be processed.</p></dd>


<dt>standardize</dt>
<dd><p>logical flag indicating if the molecular signatures should
be scaled. Advised to be set to <code>TRUE</code>.</p></dd>


<dt>parallel</dt>
<dd><p>parallel argument to internally used
<code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></code> function. Advised to be set to <code>FALSE</code>
as it might interfere with parallelization used in <code>modelGeneExpression</code>.</p></dd>


<dt>pvalues</dt>
<dd><p>logical flag indicating if significance testing for the
estimated molecular signatures activities should be performed.</p></dd>


<dt>precalcmodels</dt>
<dd><p>optional list of precomputed <code>'cv.glmnet'</code> objects
for each molecular signature and sample. The elements of this list should
be matching the <code>xnames</code> vector. Each of those elements should be a
named list holding <code>'cv.glmnet'</code> objects for each sample. If provided
those models will be used instead of running regression from scratch.</p></dd>


<dt>...</dt>
<dd><p>arguments passed to glmnet::cv.glmnet.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Nested list with following elements</p><dl><dt>regression_models</dt>
<dd><p>Named list with elements corresponding to
signatures specified in <code>xnames</code>. Each of these is a list holding
<code>'cv.glmnet'</code> objects corresponding to each sample.</p></dd>

<dt>pvalues</dt>
<dd><p>Named list with elements corresponding to
signatures specified in <code>xnames</code>. Each of these is a list holding
<code>data.frame</code> of signature's p-values and test statistics
estimated for each sample.</p></dd>

<dt>zscore_avg</dt>
<dd><p>Named list with elements corresponding to
signatures specified in <code>xnames</code>. Each of these is a <code>matrix</code>
holding replicate average Z-scores with columns corresponding to groups
in the design.</p></dd>

<dt>coef_avg</dt>
<dd><p>Named list with elements corresponding to
signatures specified in <code>xnames</code>. Each of these is a <code>matrix</code>
holding replicate averaged signatures activities with columns
corresponding to groups in the design.</p></dd>

<dt>results</dt>
<dd><p>Named list of a <code>data.frame</code>s holding replicate
average molecular signatures, overall molecular signatures Z-score and
p-values calculated over groups using Stouffer's and Fisher's methods.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For speeding up the calculations consider lowering number of folds used in
internally run <code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></code> by specifying <code>nfolds</code>
argument. By default 10 fold cross validation is used.</p>
<p>The relationship between the expression (Y) and molecular signatures (X) is
described using linear model formulation. The pipeline attempts to model the
change in expression between basal expression level (u) and each sample, with
the goal of finding the unknown molecular signatures activities. Linear
models are fit using popular ridge regression implementation
<a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a> (Friedman, Hastie, and Tibshirani 2010).</p>
<p>If <code>pvalues</code> is set to <code>TRUE</code> the significance of the estimated
molecular signatures activities is tested using methodology introduced by
(Cule, Vineis, and De Iorio 2011) which original implementation can be found
in <a href="https://rdrr.io/pkg/ridge/man/ridge-package.html" class="external-link">ridge-package</a>.</p>
<p>If replicates are available the signatures activities estimates and
their standard error estimates can be combined. This is done by averaging
signatures activities estimates and pooling their significance estimates
using Stouffer's method for the Z-scores and Fisher's method for the p-values.</p>
<p>For detailed pipeline description we refer interested user to paper
accompanying this package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"rinderpest_mini"</span>, <span class="st">"remap_mini"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">base_lvl</span> <span class="op">&lt;-</span> <span class="st">"00hr"</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>           <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>           <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>           <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>           <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>           <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>           <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>           <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>           <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ncol <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="fl">9</span>,</span></span>
<span class="r-in"><span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rinderpest_mini</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"00hr"</span>, <span class="st">"12hr"</span>, <span class="st">"24hr"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepareCountsForRegression.html">prepareCountsForRegression</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  counts <span class="op">=</span> <span class="va">rinderpest_mini</span>,</span></span>
<span class="r-in"><span>  design <span class="op">=</span> <span class="va">design</span>,</span></span>
<span class="r-in"><span>  base_lvl <span class="op">=</span> <span class="va">base_lvl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="addSignatures.html">addSignatures</a></span><span class="op">(</span><span class="va">mae</span>, remap <span class="op">=</span> <span class="va">remap_mini</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="filterSignatures.html">filterSignatures</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">modelGeneExpression</span><span class="op">(</span></span></span>
<span class="r-in"><span>  mae <span class="op">=</span> <span class="va">mae</span>,</span></span>
<span class="r-in"><span>  xnames <span class="op">=</span> <span class="st">"remap"</span>,</span></span>
<span class="r-in"><span>  nfolds <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ modelGeneExpression: started ridge regression Wed Aug  2 11:20:01 2023 ------##</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>executing %dopar% sequentially: no parallel backend registered</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loaded glmnet 4.1-7</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ modelGeneExpression: finished ridge regressionWed Aug  2 11:21:49 2023 ------##</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ modelGeneExpression: started significance testing  Wed Aug  2 11:21:49 2023 ------##</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ##------ modelGeneExpression: finished significance testing  Wed Aug  2 11:21:56 2023 ------##</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Maciej Migdał, Bogumił Kaczkowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

